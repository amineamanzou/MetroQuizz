<html>
    <head>
        <meta charset="utf-8">
        <link rel="stylesheet" type="text/css" media="screen" href="css/bootstrap.min.css">
    </head>
    <body>
        <div class="well span"><h4>MetroQuizz Game</h4></div>
        <div class="container">
            <div class="well span">
                <div class="row">
                    <div class="col-xs-12 col-md-8">
                        <canvas id="carte" width="725" height="725" style="background-image: url('img/ratp.png');background-size: 725px 725px"></canvas>
                    </div>
                    <div class="col-xs-6 col-md-4">
                        <label>SÃ©lectionner une station</label>
                        <div class="row">
                            <div class="col-lg-12">
                                <div class="input-group">
                                    <input type="text" class="form-control">
                                    <span class="input-group-btn">
                                        <button class="btn btn-default" type="button" onclick="loadCoordinate()">Valider !</button>
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </body>
</html>

<script type="application/javascript" src="js/quizz.js"></script>
<script type="application/javascript">
    var angle = 0;

    var requestAnimationFrame = window.requestAnimationFrame ||
        window.mozRequestAnimationFrame ||
        window.webkitRequestAnimationFrame ||
        window.msRequestAnimationFrame;
    
    var pattern;
    var imageObj = new Image();
    imageObj.onload = function() {
        var mainCanvas = document.getElementById("carte");
        var mainContext = mainCanvas.getContext('2d');
        var canvasWidth = mainCanvas.width;
        var canvasHeight = mainCanvas.height;
        pattern = mainContext.createPattern(imageObj, 'repeat');

        mainContext.rect(0, 0, canvasWidth, canvasHeight);
        mainContext.fillStyle = pattern;
        mainContext.fill();
		
        if(imageObj.height > canvasHeight) {
			imageObj.width *= canvasHeight / imageObj.height;
			imageObj.height = canvasHeight;
		}
		mainContext.clearRect(0, 0, canvasWidth, canvasHeight);
		mainContext.drawImage(imageObj, 0, 0, canvasWidth, canvasHeight);
    };
    imageObj.src = 'img/ratp.png';
    
    var posX = new Number();
    var posY = new Number();
    function drawCircle() {
        var mainCanvas = document.getElementById("carte");
        var mainContext = mainCanvas.getContext('2d');
        var canvasWidth = mainCanvas.width;
        var canvasHeight = mainCanvas.height;
        mainContext.clearRect(0, 0, canvasWidth, canvasHeight);

        // color in the background
        mainContext.fillStyle = pattern;
        mainContext.fillRect(0, 0, canvasWidth, canvasHeight);

        // draw the circle
        mainContext.beginPath();

        var radius = 1 + 10 * Math.abs(Math.cos(angle));
        mainContext.arc(posX, posY, radius, 0, Math.PI * 2, false);
        mainContext.closePath();

        // color in the circle
        mainContext.fillStyle = "#f00";
        mainContext.fill();

        angle += Math.PI / 64;

        requestAnimationFrame(drawCircle);
    }
    
    document.addEventListener("DOMContentLoaded", init, false);
    function init()
    {
        var canvas = document.getElementById("carte");
        posX = 0;
        posY = 0;
        drawCircle();
        canvas.addEventListener("mousedown", getPosition, false);
    }
    
    function getPosition(event)
    {
        var canvas = document.getElementById("carte");

        if (event.x != undefined && event.y != undefined)
        {
          posX = event.x;
          posY = event.y;
        }
        else // Firefox method to get the position
        {
          posX = event.clientX + document.body.scrollLeft +
              document.documentElement.scrollLeft;
          posY = event.clientY + document.body.scrollTop +
              document.documentElement.scrollTop;
        }
        posX -= canvas.offsetLeft;
        posY -= canvas.offsetTop;
        posX -= 240;
        posY -= 120;
        console.log(canvas.offsetLeft + ' ' + canvas.offsetTop);
        console.log(posX + ' ' + posY);
    }
    
    function getCoordinate(){
        
    }
    
</script>
